<app-header></app-header>

<!-- @if (loading) {
  <p-skeleton class="mb-2" borderRadius="16px"></p-skeleton>
  <p-skeleton width="10rem" class="mb-2" borderRadius="16px"></p-skeleton>
  <p-skeleton width="5rem" class="mb-2" borderRadius="16px"></p-skeleton>
  <p-skeleton height="2rem" class="mb-2" borderRadius="16px"></p-skeleton>
  <p-skeleton width="10rem" height="4rem" borderRadius="16px"></p-skeleton>
} @else { -->
@if (portfolio$ | async; as portfolio) {
  <div class="flex flex-col mt-4">
    <h1 class="text-gray-400 font-semibold text-xl">{{ portfolio.name }} ðŸš€</h1>
    <div class="flex flex-row justify-between flex-wrap">
      <div class="flex flex-col">
        <span class="text-4xl text-gray-900 font-extrabold">{{
          portfolio.totalValue | currency
        }}</span>

        <span class="text-green-400 font-medium text-lg"
          >+1215478 (24h prices change) ðŸ“ˆ</span
        >
      </div>

      <div class="flex flex-row flex-wrap mr-[3rem]">
        <div class="px-2 flex flex-wrap">
          <p-button
            (click)="showDialog()"
            icon="pi pi-spin pi-bitcoin"
            label="Add Transaction"
            iconPos="right"
            [rounded]="true"
            [raised]="true"
          >
          </p-button>

          <p-dialog [(visible)]="visible" [modal]="true">
            <ng-template pTemplate="headless">
              <div
                class="bg-white overflow-auto border-black border rounded-md sm:w-[35rem] w-full"
              >
                <app-wizard (complete)="hideDialog()"></app-wizard>
              </div>
            </ng-template>
          </p-dialog>
        </div>

        <div class="px-2">
          <p-button
            icon="pi pi-ellipsis-v"
            [rounded]="true"
            [raised]="true"
            text="true"
          >
          </p-button>
        </div>
      </div>
    </div>
  </div>

  <div class="flex flex-row mt-[2.5rem] justify-normal items-start flex-wrap">
    <p-card header="Profit/Loss">
      @if (portfolio.totalProfitAndLossAmount > 0) {
        <span class="m-0 text-green-700 text-lg font-bold">
          +{{ portfolio.totalProfitAndLossAmount | currency }} ðŸ’¸
        </span>
      } @else if (portfolio.totalProfitAndLossAmount < 0) {
        <span class="m-0 text-red-700 text-lg font-bold">
          {{ portfolio.totalProfitAndLossAmount | currency }} ðŸ©¸
        </span>
      } @else if (portfolio.totalProfitAndLossAmount === 0) {
        <span class="m-0 text-grey-900 text-lg">
          {{ portfolio.totalProfitAndLossAmount | currency }}
        </span>
      }
    </p-card>

    <p-card header="Number of Assets held">
      <p class="m-0 text-center">{{ portfolio.assets.length }}</p>
    </p-card>

    <p-card header="Simple Card">
      <p class="m-0">Lorem ipsum dolor sit amet...</p>
    </p-card>
  </div>

  <div class="flex flex-row items-center">
    <app-pie-chart></app-pie-chart>
  </div>

  <div class="my-[5rem] border border-black rounded-md p-[1.25rem]">
    <h2 class="font-bold text-2xl text-gray-950">Assets</h2>
    <app-assets-table (complete)="hideDialog()"> </app-assets-table>
  </div>
} @else {
  @defer (on timer(1s)) {
    <h1>hmmmm it seems that you dont have a portfolio , create one !!</h1>
    <p-button
      (click)="showForm()"
      icon="pi pi-plus"
      label="Create new form"
      iconPos="right"
      [rounded]="true"
      [raised]="true"
      class="transition-all focus:scale-110 hover:scale-110 active:scale-105"
    ></p-button>
    <p-dialog
      header="Header"
      [(visible)]="portfolioVisible"
      [style]="{ width: '50vw' }"
      [closable]="true"
      [modal]="true"
    >
      <app-portfolio></app-portfolio>
    </p-dialog>
  }
}
